<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>0xHeart - T·ªè T√¨nh C√πng Em</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style>
    body {
      background: #0d0d1a;
      color: #e0e0e0;
      overflow: hidden;
      font-family: 'Courier New', monospace;
    }
    #particles-js {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }
    .heart {
      position: absolute;
      width: 20px;
      height: 20px;
      background: #ff5e62;
      transform: rotate(45deg);
      animation: fall 5s linear infinite;
      opacity: 0.7;
    }
    .heart::before,
    .heart::after {
      content: '';
      position: absolute;
      width: 20px;
      height: 20px;
      background: #ff5e62;
      border-radius: 50%;
    }
    .heart::before { top: -10px; left: 0; }
    .heart::after { top: 0; left: -10px; }
    @keyframes fall {
      0% { transform: translateY(-100vh) rotate(45deg) scale(1); opacity: 1; }
      100% { transform: translateY(100vh) rotate(45deg) scale(0.5); opacity: 0; }
    }
    .typing {
      display: inline-block;
      white-space: nowrap;
      overflow: hidden;
      border-right: 3px solid #00ff88;
      animation: blink 0.75s step-end infinite;
    }
    @keyframes blink {
      50% { border-color: transparent; }
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.5s ease;
    }
    .modal.show {
      opacity: 1;
    }
    .modal-content {
      animation: fadeIn 0.5s ease-out;
      background: #16213e;
      border: 2px solid #00ff88;
      box-shadow: 0 0 30px rgba(0, 255, 136, 0.6);
    }
    @keyframes fadeIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    .glitch {
      position: relative;
      color: #00ff88;
      animation: glitch 1s linear infinite;
    }
    .glitch::before,
    .glitch::after {
      content: attr(data-text);
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    .glitch::before {
      color: #ff00ff;
      animation: glitch-top 1s linear infinite;
      clip-path: polygon(0 0, 100% 0, 100% 33%, 0 33%);
    }
    .glitch::after {
      color: #00ffff;
      animation: glitch-bottom 1.5s linear infinite;
      clip-path: polygon(0 67%, 100% 67%, 100% 100%, 0 100%);
    }
    @keyframes glitch {
      2%, 64% { transform: translate(2px, 0) skew(0deg); }
      4%, 60% { transform: translate(-2px, 0) skew(0deg); }
      62% { transform: translate(0, 0) skew(5deg); }
    }
    @keyframes glitch-top {
      2%, 64% { transform: translate(2px, -2px); }
      4%, 60% { transform: translate(-2px, 2px); }
      62% { transform: translate(0, 0) skew(-5deg); }
    }
    @keyframes glitch-bottom {
      2%, 64% { transform: translate(-2px, 2px); }
      4%, 60% { transform: translate(2px, -2px); }
      62% { transform: translate(0, 0) skew(5deg); }
    }
    .parallax {
      transform: perspective(500px) translateZ(0);
      transition: transform 0.3s ease;
    }
    canvas {
      position: fixed;
      top: 0;
      left: 0;
      z-index: -2;
      opacity: 0.3;
    }
    @media (max-width: 640px) {
      .modal-content {
        max-width: 90%;
      }
      .glitch {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body class="flex items-center justify-center min-h-screen text-center">
  <canvas id="heart-canvas"></canvas>
  <div id="particles-js"></div>
  <div id="heart-container"></div>
  <div class="p-8 max-w-lg mx-auto bg-gray-900 bg-opacity-80 rounded-xl shadow-2xl border border-green-400 parallax">
    <h1 id="title" class="text-4xl font-bold mb-6 glitch" data-text="0xHeart - G·ª≠i Em">0xHeart - G·ª≠i Em</h1>
    <p id="typing-text" class="text-green-400 text-lg mb-6 typing"></p>
    <button id="reveal-btn" class="bg-gradient-to-r from-green-500 to-cyan-500 text-black px-8 py-3 rounded-lg hover:from-green-600 hover:to-cyan-600 transition duration-300 transform hover:scale-110">
      Execute Love Protocol
    </button>
    <div class="mt-4 flex justify-center items-center">
      <button id="toggle-music" class="text-green-400 hover:text-green-600">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path></svg>
      </button>
    </div>
  </div>

  <!-- Modal T·ªè T√¨nh -->
  <div id="modal" class="modal">
    <div class="modal-content p-8 rounded-xl max-w-md mx-auto text-center">
      <h2 class="text-2xl font-bold text-green- itle" data-text="L·ªùi T·ªè T√¨nh...">L·ªùi T·ªè T√¨nh...</h2>
      <p id="love-message" class="text-gray-300 mb-6"></p>
      <div class="flex flex-col gap-4 mb-6">
        <button id="accept-btn" class="bg-green-500 text-black px-6 py-2 rounded-lg hover:bg-green-600 transition duration-300">Ch·∫•p Nh·∫≠n ‚ù§Ô∏è</button>
        <button id="wait-btn" class="bg-yellow-500 text-black px-6 py-2 rounded-lg hover:bg-yellow-600 transition duration-300">ƒê·ªÉ Anh Ch·ªù Th√™m Nh√© üòâ</button>
        <button id="reject-btn" class="bg-red-500 text-black px-6 py-2 rounded-lg hover:bg-red-600 transition duration-300">T·ª´ Ch·ªëi üòî</button>
      </div>
      <button id="close-modal" class="mt-4 bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition duration-300">Tho√°t</button>
    </div>
  </div>

  <!-- Modal Ph·∫£n H·ªìi -->
  <div id="response-modal" class="modal">
    <div class="modal-content p-8 rounded-xl max-w-md mx-auto text-center">
      <h2 class="text-2xl font-bold text-green-400 mb-4 glitch" data-text="Ph·∫£n H·ªìi T·ª´ Em">Ph·∫£n H·ªìi T·ª´ Em</h2>
      <p id="response-message" class="text-gray-300 mb-6"></p>
      <button id="copy-response" class="bg-blue-500 text-black px-6 py-2 rounded-lg hover:bg-blue-600 transition duration-300">Sao Ch√©p Ph·∫£n H·ªìi</button>
      <button id="close-response-modal" class="mt-4 bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition duration-300">ƒê√≥ng</button>
    </div>
  </div>

  <audio id="background-music" loop>
    <source src="https://www.bensound.com/bensound-music/bensound-sweet.mp3" type="audio/mpeg">
  </audio>
  <audio id="click-sound" src="https://www.soundjay.com/buttons/beep-01a.mp3"></audio>

  <script>
    // L·∫•y t√™n crush t·ª´ query parameter ho·∫∑c m·∫∑c ƒë·ªãnh
    const urlParams = new URLSearchParams(window.location.search);
    const crushName = urlParams.get('name') || 'Em'; // Thay 'Em' b·∫±ng t√™n crush n·∫øu kh√¥ng d√πng query

    // C·∫≠p nh·∫≠t ti√™u ƒë·ªÅ
    document.getElementById('title').setAttribute('data-text', `0xHeart - G·ª≠i ${crushName}`);
    document.getElementById('title').textContent = `0xHeart - G·ª≠i ${crushName}`;

    // Particles.js
    particlesJS('particles-js', {
      particles: {
        number: { value: 150, density: { enable: true, value_area: 800 } },
        color: { value: ['#00ff88', '#ff5e62', '#00ffff'] },
        shape: { type: 'circle' },
        opacity: { value: 0.6, random: true },
        size: { value: 4, random: true },
        line_linked: { enable: true, distance: 120, color: '#00ff88', opacity: 0.4, width: 1 },
        move: { enable: true, speed: 3, direction: 'none', random: true }
      },
      interactivity: {
        detect_on: 'canvas',
        events: { onhover: { enable: true, mode: 'grab' }, onclick: { enable: true, mode: 'push' } },
        modes: { grab: { distance: 140 }, push: { particles_nb: 4 } }
      }
    });

    // Tr√°i tim r∆°i
    function createHeart() {
      const heart = document.createElement('div');
      heart.classList.add('heart');
      heart.style.left = Math.random() * 100 + 'vw';
      heart.style.animationDuration = Math.random() * 3 + 4 + 's';
      document.getElementById('heart-container').appendChild(heart);
      setTimeout(() => heart.remove(), 6000);
    }
    setInterval(createHeart, 300);

    // Canvas v·∫Ω tr√°i tim
    const canvas = document.getElementById('heart-canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    let t = 0;
    function drawHeart() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.beginPath();
      for (let i = 0; i < Math.PI * 2; i += 0.01) {
        const x = 16 * Math.pow(Math.sin(i), 3);
        const y = 13 * Math.cos(i) - 5 * Math.cos(2 * i) - 2 * Math.cos(3 * i) - Math.cos(4 * i);
        ctx.lineTo(canvas.width / 2 + x * 10 * Math.sin(t), canvas.height / 2 - y * 10);
      }
      ctx.fillStyle = 'rgba(255, 94, 98, 0.5)';
      ctx.fill();
      t += 0.02;
      requestAnimationFrame(drawHeart);
    }
    drawHeart();

    // Hi·ªáu ·ª©ng g√µ ch·ªØ
    const text = `Booting love system for ${crushName}...`;
    let index = 0;
    const typingText = document.getElementById('typing-text');
    function type() {
      if (index < text.length) {
        typingText.textContent += text.charAt(index);
        index++;
        setTimeout(type, 80);
      }
    }
    window.onload = type;

    // Hi·ªáu ·ª©ng parallax
    document.addEventListener('mousemove', (e) => {
      const parallax = document.querySelector('.parallax');
      const x = (e.clientX / window.innerWidth - 0.5) * 20;
      const y = (e.clientY / window.innerHeight - 0.5) * 20;
      parallax.style.transform = `perspective(500px) translate3d(${x}px, ${y}px, 0)`;
    });

    // X·ª≠ l√Ω logic
    const modal = document.getElementById('modal');
    const responseModal = document.getElementById('response-modal');
    const revealBtn = document.getElementById('reveal-btn');
    const closeModal = document.getElementById('close-modal');
    const acceptBtn = document.getElementById('accept-btn');
    const waitBtn = document.getElementById('wait-btn');
    const rejectBtn = document.getElementById('reject-btn');
    const copyResponse = document.getElementById('copy-response');
    const closeResponseModal = document.getElementById('close-response-modal');
    const loveMessage = document.getElementById('love-message');
    const responseMessage = document.getElementById('response-message');
    const music = document.getElementById('background-music');
    const clickSound = document.getElementById('click-sound');
    let isMusicPlaying = false;

    revealBtn.addEventListener('click', () => {
      loveMessage.textContent = `${crushName} √†, trong source code c·ªßa anh, em l√† constant duy nh·∫•t kh√¥ng bao gi·ªù thay ƒë·ªïi. M·ªói n·ª• c∆∞·ªùi c·ªßa em l√† m·ªôt API call khi·∫øn tr√°i tim anh response 200 OK. Anh kh√¥ng h·ª©a s·∫Ω hack c·∫£ universe, nh∆∞ng anh h·ª©a s·∫Ω dedicate c·∫£ CPU c·ªßa m√¨nh ƒë·ªÉ y√™u th∆∞∆°ng v√† b·∫£o v·ªá em. Em c√≥ ƒë·ªìng √Ω l√†m "commit" l·ªõn nh·∫•t trong repo c·ªßa anh kh√¥ng? üíæ`;
      modal.style.display = 'flex';
      modal.classList.add('show');
      if (isMusicPlaying) music.play();
      clickSound.play();
      revealBtn.classList.add('hidden');
    });

    closeModal.addEventListener('click', () => {
      modal.classList.remove('show');
      setTimeout(() => { modal.style.display = 'none'; }, 500);
      music.pause();
      clickSound.play();
      revealBtn.classList.remove('hidden');
    });

    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.classList.remove('show');
        setTimeout(() => { modal.style.display = 'none'; }, 500);
        music.pause();
        clickSound.play();
        revealBtn.classList.remove('hidden');
      }
    });

    function showResponseModal(choice, message) {
      modal.classList.remove('show');
      setTimeout(() => {
        modal.style.display = 'none';
        responseMessage.textContent = `${message}`;
        responseModal.style.display = 'flex';
        responseModal.classList.add('show');
      }, 500);
      clickSound.play();
    }

    acceptBtn.addEventListener('click', () => {
      confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
      showResponseModal('Ch·∫•p Nh·∫≠n ‚ù§Ô∏è', `${crushName} ƒë√£ ch·∫•p nh·∫≠n! üéâ Tr√°i tim anh ƒëang overload v√¨ h·∫°nh ph√∫c! Em ch√≠nh l√† "merge" ho√†n h·∫£o cho branch cu·ªôc ƒë·ªùi anh! ‚ù§Ô∏è`);
    });

    waitBtn.addEventListener('click', () => {
      showResponseModal('ƒê·ªÉ Anh Ch·ªù Th√™m Nh√© üòâ', `Okay, ${crushName}! Anh s·∫Ω ki√™n nh·∫´n nh∆∞ m·ªôt async function ch·ªù resolve. H√£y cho anh c∆° h·ªôi nh√©! üòâ`);
    });

    rejectBtn.addEventListener('click', () => {
      showResponseModal('T·ª´ Ch·ªëi üòî', `√îi, ${crushName}... Tr√°i tim anh v·ª´a g·∫∑p l·ªói 404: Love Not Found. üòî Nh∆∞ng anh v·∫´n s·∫Ω debug v√† th·ª≠ l·∫°i, v√¨ em x·ª©ng ƒë√°ng!`);
    });

    copyResponse.addEventListener('click', () => {
      navigator.clipboard.writeText(responseMessage.textContent).then(() => {
        alert('ƒê√£ sao ch√©p ph·∫£n h·ªìi! G·ª≠i cho anh ƒë·ªÉ bi·∫øt c·∫£m x√∫c c·ªßa em nh√©!');
      });
      clickSound.play();
    });

    closeResponseModal.addEventListener('click', () => {
      responseModal.classList.remove('show');
      setTimeout(() => {
        responseModal.style.display = 'none';
        revealBtn.classList.remove('hidden');
      }, 500);
      music.pause();
      clickSound.play();
    });

    responseModal.addEventListener('click', (e) => {
      if (e.target === responseModal) {
        responseModal.classList.remove('show');
        setTimeout(() => {
          responseModal.style.display = 'none';
          revealBtn.classList.remove('hidden');
        }, 500);
        music.pause();
        clickSound.play();
      }
    });

    document.getElementById('toggle-music').addEventListener('click', () => {
      isMusicPlaying = !isMusicPlaying;
      if (isMusicPlaying) {
        music.play();
        document.getElementById('toggle-music').innerHTML = `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path></svg>`;
      } else {
        music.pause();
        document.getElementById('toggle-music').innerHTML = `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15zm10.414-2l4-4m0 4l-4-4"></path></svg>`;
      }
      clickSound.play();
    });
  </script>
</body>
</html>